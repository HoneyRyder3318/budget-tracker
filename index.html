<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

const PlusCircle = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="16"></line>
        <line x1="8" y1="12" x2="16" y2="12"></line>
    </svg>
);

const TrendingUp = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
        <polyline points="17 6 23 6 23 12"></polyline>
    </svg>
);

const TrendingDown = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
        <polyline points="17 18 23 18 23 12"></polyline>
    </svg>
);

const Download = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
    </svg>
);

const Upload = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="17 8 12 3 7 8"></polyline>
        <line x1="12" y1="3" x2="12" y2="15"></line>
    </svg>
);

const DollarSign = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="12" y1="1" x2="12" y2="23"></line>
        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
    </svg>
);

const AlertCircle = ({ size = 24 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
);
      function BudgetTracker() {
    const [transactions, setTransactions] = useState([]);
    const [subscriptions, setSubscriptions] = useState([]);
    const [bills, setBills] = useState([]);
    const [budgets, setBudgets] = useState([]);
    const [savingsBalance, setSavingsBalance] = useState(0);
    const [activeTab, setActiveTab] = useState('dashboard');
    const [showAddTransaction, setShowAddTransaction] = useState(false);
    const [showAddSubscription, setShowAddSubscription] = useState(false);
    const [showAddBill, setShowAddBill] = useState(false);
    const [showAddBudget, setShowAddBudget] = useState(false);
    const [editingSubscription, setEditingSubscription] = useState(null);
    const [editingBill, setEditingBill] = useState(null);

    useEffect(() => {
        const saved = localStorage.getItem('budgetData');
        if (saved) {
            const data = JSON.parse(saved);
            setTransactions(data.transactions || []);
            setSubscriptions(data.subscriptions || []);
            setBills(data.bills || []);
            setBudgets(data.budgets || []);
            setSavingsBalance(data.savingsBalance || 0);
        }
    }, []);

    useEffect(() => {
        localStorage.setItem('budgetData', JSON.stringify({ 
            transactions, subscriptions, bills, budgets, savingsBalance 
        }));
    }, [transactions, subscriptions, bills, budgets, savingsBalance]);

    const addTransaction = (transaction) => {
        const newTransaction = { ...transaction, id: Date.now() };
        setTransactions(prev => [...prev, newTransaction]);
        setShowAddTransaction(false);
    };

    const addSubscription = (subscription) => {
        const frequency = subscription.frequency || 'Monthly';
        const category = subscription.category || 'Other';
        const savingsLog = frequency !== 'Monthly' ? [] : undefined;
        const newSubscription = { ...subscription, id: Date.now(), frequency, category, savingsLog };
        setSubscriptions(prev => [...prev, newSubscription]);
        setShowAddSubscription(false);
    };

    const addBill = (bill) => {
        const frequency = bill.frequency || 'Monthly';
        const category = bill.category || 'Other';
        const savingsLog = frequency !== 'Monthly' ? [] : undefined;
        const newBill = { ...bill, id: Date.now(), frequency, category, savingsLog };
        setBills(prev => [...prev, newBill]);
        setShowAddBill(false);
    };

    const addBudget = (budget) => {
        const newBudget = { ...budget, id: Date.now() };
        setBudgets(prev => [...prev, newBudget]);
        setShowAddBudget(false);
    };

    const updateSubscription = (id, updatedData) => {
        setSubscriptions(subscriptions.map(s => 
            s.id === id ? { ...s, ...updatedData } : s
        ));
        setEditingSubscription(null);
    };

    const updateBill = (id, updatedData) => {
        setBills(bills.map(b => 
            b.id === id ? { ...b, ...updatedData } : b
        ));
        setEditingBill(null);
    };

    const deleteTransaction = (id) => setTransactions(transactions.filter(t => t.id !== id));
    const deleteSubscription = (id) => setSubscriptions(subscriptions.filter(s => s.id !== id));
    const deleteBill = (id) => setBills(bills.filter(b => b.id !== id));

    const toggleSubscriptionFlag = (id) => {
        setSubscriptions(subscriptions.map(s => 
            s.id === id ? { ...s, flaggedForCancellation: !s.flaggedForCancellation } : s
        ));
    };

    const toggleBillFlag = (id) => {
        setBills(bills.map(b => 
            b.id === id ? { ...b, flaggedForReview: !b.flaggedForReview } : b
        ));
    };

    const addSavingsPayment = (id, amount, type) => {
        const date = new Date().toISOString();
        if (type === 'subscription') {
            setSubscriptions(subscriptions.map(s => {
                if (s.id === id) {
                    const log = s.savingsLog || [];
                    return { ...s, savingsLog: [...log, { date, amount: parseFloat(amount) }] };
                }
                return s;
            }));
        } else {
            setBills(bills.map(b => {
                if (b.id === id) {
                    const log = b.savingsLog || [];
                    return { ...b, savingsLog: [...log, { date, amount: parseFloat(amount) }] };
                }
                return b;
            }));
        }
    };

    const adjustSavings = (id, newAmount, type) => {
        if (type === 'subscription') {
            setSubscriptions(subscriptions.map(s => 
                s.id === id ? { ...s, savingsLog: [{ date: new Date().toISOString(), amount: parseFloat(newAmount) }] } : s
            ));
        } else {
            setBills(bills.map(b => 
                b.id === id ? { ...b, savingsLog: [{ date: new Date().toISOString(), amount: parseFloat(newAmount) }] } : b
            ));
        }
    };

    const exportData = () => {
        const data = { transactions, subscriptions, bills, budgets, savingsBalance, exportDate: new Date().toISOString() };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'budget-backup.json';
        a.click();
    };

    const importData = (e) => {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                try {
                    const data = JSON.parse(event.target.result);
                    if (data.transactions) setTransactions(data.transactions);
                    if (data.subscriptions) setSubscriptions(data.subscriptions);
                    if (data.bills) setBills(data.bills);
                    if (data.budgets) setBudgets(data.budgets);
                    if (data.savingsBalance !== undefined) setSavingsBalance(data.savingsBalance);
                    alert('Data imported successfully!');
                } catch (error) {
                    alert('Error importing data');
                }
            };
            reader.readAsText(file);
        }
    };

    const getMonthlyAmount = (amount, frequency) => {
        const frequencyMap = { 'Monthly': 1, 'Quarterly': 3, 'Semi-Annual': 6, 'Annual': 12 };
        return parseFloat(amount) / (frequencyMap[frequency] || 1);
    };

    const getSavedAmount = (item) => {
        if (!item.savingsLog || item.savingsLog.length === 0) return 0;
        return item.savingsLog.reduce((sum, entry) => sum + entry.amount, 0);
    };

    const calculateTotals = () => {
        const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + parseFloat(t.amount), 0);
        const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + parseFloat(t.amount), 0);
        return { income, expenses, balance: income - expenses };
    };

    const getCategorySpending = (category) => {
        return transactions.filter(t => t.type === 'expense' && t.category === category).reduce((sum, t) => sum + parseFloat(t.amount), 0);
    };

    const getAllCategorySpending = () => {
        const spending = {};
        
        transactions.filter(t => t.type === 'expense').forEach(t => {
            spending[t.category] = (spending[t.category] || 0) + parseFloat(t.amount);
        });
        
        subscriptions.forEach(sub => {
            const monthly = getMonthlyAmount(sub.amount, sub.frequency || 'Monthly');
            const category = sub.category || 'Subscriptions';
            spending[category] = (spending[category] || 0) + monthly;
        });
        
        bills.forEach(bill => {
            const monthly = getMonthlyAmount(bill.amount, bill.frequency || 'Monthly');
            const category = bill.category || 'Bills';
            spending[category] = (spending[category] || 0) + monthly;
        });
        
        return spending;
    };

    const totals = calculateTotals();
        return (
        <div className="min-h-screen bg-gray-50">
            <div className="bg-blue-600 text-white p-4 shadow-lg">
                <h1 className="text-2xl font-bold">Budget Tracker</h1>
                <p className="text-blue-100 text-sm">Take control of your finances</p>
            </div>

            <div className="bg-white border-b sticky top-0 z-10 shadow-sm">
                <div className="flex overflow-x-auto">
                    {['dashboard', 'transactions', 'subscriptions', 'bills', 'budgets'].map(tab => (
                        <button 
                            key={tab} 
                            onClick={() => setActiveTab(tab)} 
                            className={`px-6 py-3 font-medium whitespace-nowrap ${activeTab === tab ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-600 hover:text-gray-900'}`}
                        >
                            {tab.charAt(0).toUpperCase() + tab.slice(1)}
                        </button>
                    ))}
                </div>
            </div>

            <div className="max-w-6xl mx-auto p-4">
                {activeTab === 'dashboard' && (
                    <Dashboard 
                        totals={totals} 
                        subscriptions={subscriptions}
                        bills={bills}
                        budgets={budgets}
                        savingsBalance={savingsBalance}
                        setSavingsBalance={setSavingsBalance}
                        getCategorySpending={getCategorySpending}
                        getAllCategorySpending={getAllCategorySpending}
                        exportData={exportData} 
                        importData={importData}
                        getMonthlyAmount={getMonthlyAmount}
                        getSavedAmount={getSavedAmount}
                        addSavingsPayment={addSavingsPayment}
                        adjustSavings={adjustSavings}
                    />
                )}
                {activeTab === 'transactions' && (
                    <Transactions 
                        transactions={transactions} 
                        onAdd={() => setShowAddTransaction(true)} 
                        onDelete={deleteTransaction} 
                    />
                )}
                {activeTab === 'subscriptions' && (
                    <Subscriptions 
                        subscriptions={subscriptions} 
                        onAdd={() => setShowAddSubscription(true)} 
                        onEdit={setEditingSubscription}
                        onDelete={deleteSubscription} 
                        onToggleFlag={toggleSubscriptionFlag}
                        getMonthlyAmount={getMonthlyAmount}
                        getSavedAmount={getSavedAmount}
                        addSavingsPayment={addSavingsPayment}
                        adjustSavings={adjustSavings}
                    />
                )}
                {activeTab === 'bills' && (
                    <Bills 
                        bills={bills} 
                        onAdd={() => setShowAddBill(true)} 
                        onEdit={setEditingBill}
                        onDelete={deleteBill} 
                        onToggleFlag={toggleBillFlag}
                        getMonthlyAmount={getMonthlyAmount}
                        getSavedAmount={getSavedAmount}
                        addSavingsPayment={addSavingsPayment}
                        adjustSavings={adjustSavings}
                    />
                )}
                {activeTab === 'budgets' && (
                    <Budgets 
                        budgets={budgets} 
                        onAdd={() => setShowAddBudget(true)} 
                        getCategorySpending={getCategorySpending} 
                    />
                )}
            </div>

            {showAddTransaction && <AddTransactionModal onClose={() => setShowAddTransaction(false)} onAdd={addTransaction} />}
            {showAddSubscription && <AddSubscriptionModal onClose={() => setShowAddSubscription(false)} onAdd={addSubscription} />}
            {showAddBill && <AddBillModal onClose={() => setShowAddBill(false)} onAdd={addBill} />}
            {showAddBudget && <AddBudgetModal onClose={() => setShowAddBudget(false)} onAdd={addBudget} />}
            {editingSubscription && <EditSubscriptionModal subscription={editingSubscription} onClose={() => setEditingSubscription(null)} onUpdate={updateSubscription} />}
            {editingBill && <EditBillModal bill={editingBill} onClose={() => setEditingBill(null)} onUpdate={updateBill} />}
        </div>
    );
}
      function Dashboard({ totals, subscriptions, bills, budgets, savingsBalance, setSavingsBalance, getCategorySpending, getAllCategorySpending, exportData, importData, getMonthlyAmount, getSavedAmount, addSavingsPayment, adjustSavings }) {
    const [editingSavings, setEditingSavings] = useState(false);
    const [tempSavings, setTempSavings] = useState(savingsBalance);

    const allRecurring = [...subscriptions, ...bills];
    const upcomingPayments = allRecurring
        .map(item => {
            const daysUntil = Math.ceil((new Date(item.nextPayment) - new Date()) / (1000 * 60 * 60 * 24));
            return { ...item, daysUntil };
        })
        .filter(item => item.daysUntil >= 0 && item.daysUntil <= 7)
        .sort((a, b) => a.daysUntil - b.daysUntil);
    
    const totalSubscriptionCost = subscriptions.reduce((sum, sub) => sum + getMonthlyAmount(sub.amount, sub.frequency || 'Monthly'), 0);
    const totalBillsCost = bills.reduce((sum, bill) => sum + getMonthlyAmount(bill.amount, bill.frequency || 'Monthly'), 0);
    const totalRecurringCost = totalSubscriptionCost + totalBillsCost;

    const savingsItems = allRecurring.filter(item => (item.frequency || 'Monthly') !== 'Monthly');
    const totalNeededSavings = savingsItems.reduce((sum, item) => sum + parseFloat(item.amount), 0);
    const totalSaved = savingsItems.reduce((sum, item) => sum + getSavedAmount(item), 0);

    const categorySpending = getAllCategorySpending();
    const sortedCategories = Object.entries(categorySpending).sort((a, b) => b[1] - a[1]);
    const maxSpending = sortedCategories.length > 0 ? sortedCategories[0][1] : 0;

    return (
        <div className="space-y-6">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div className="bg-white p-6 rounded-lg shadow">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-gray-600 text-sm">Total Income</p>
                            <p className="text-2xl font-bold text-green-600">${totals.income.toFixed(2)}</p>
                        </div>
                        <TrendingUp className="text-green-600" size={32} />
                    </div>
                </div>
                
                <div className="bg-white p-6 rounded-lg shadow">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-gray-600 text-sm">Total Expenses</p>
                            <p className="text-2xl font-bold text-red-600">${totals.expenses.toFixed(2)}</p>
                        </div>
                        <TrendingDown className="text-red-600" size={32} />
                    </div>
                </div>
                
                <div className="bg-white p-6 rounded-lg shadow">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-gray-600 text-sm">Balance</p>
                            <p className={`text-2xl font-bold ${totals.balance >= 0 ? 'text-blue-600' : 'text-red-600'}`}>
                                ${totals.balance.toFixed(2)}
                            </p>
                        </div>
                        <DollarSign className="text-blue-600" size={32} />
                    </div>
                </div>
            </div>

            <div className="bg-white p-6 rounded-lg shadow">
                <h2 className="text-xl font-bold mb-4">Recurring Payments Summary</h2>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <p className="text-gray-600">Subscriptions</p>
                        <p className="text-2xl font-bold">{subscriptions.length}</p>
                        <p className="text-sm text-red-600">${totalSubscriptionCost.toFixed(2)}/mo</p>
                    </div>
                    <div>
                        <p className="text-gray-600">Bills</p>
                        <p className="text-2xl font-bold">{bills.length}</p>
                        <p className="text-sm text-red-600">${totalBillsCost.toFixed(2)}/mo</p>
                    </div>
                    <div>
                        <p className="text-gray-600">Total Monthly</p>
                        <p className="text-3xl font-bold text-red-600">${totalRecurringCost.toFixed(2)}</p>
                        <p className="text-sm text-gray-500">Yearly: ${(totalRecurringCost * 12).toFixed(2)}</p>
                    </div>
                </div>
            </div>

            {upcomingPayments.length > 0 && (
                <div className="bg-white p-6 rounded-lg shadow">
                    <div className="flex items-center gap-2 mb-4">
                        <AlertCircle className="text-orange-500" size={24} />
                        <h2 className="text-xl font-bold">Upcoming Payments (Next 7 Days)</h2>
                    </div>
                    <div className="space-y-3">
                        {upcomingPayments.map(payment => (
                            <div key={payment.id} className="flex justify-between items-center p-3 bg-orange-50 rounded border-l-4 border-orange-500">
                                <div>
                                    <p className="font-medium">{payment.name}</p>
                                    <p className="text-sm text-gray-600">{new Date(payment.nextPayment).toLocaleDateString()}</p>
                                </div>
                                <div className="text-right">
                                    <p className="font-bold text-orange-600">${payment.amount}</p>
                                    <p className="text-xs text-gray-600">{payment.daysUntil === 0 ? 'Today' : `${payment.daysUntil} days`}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            )}

            {sortedCategories.length > 0 && (
                <div className="bg-white p-6 rounded-lg shadow">
                    <h2 className="text-xl font-bold mb-4">Spending by Category</h2>
                    <div className="space-y-3">
                        {sortedCategories.map(([category, amount]) => {
                            const percentage = maxSpending > 0 ? (amount / maxSpending) * 100 : 0;
                            return (
                                <div key={category}>
                                    <div className="flex justify-between mb-1">
                                        <span className="font-medium">{category}</span>
                                        <span className="text-sm font-bold">${amount.toFixed(2)}</span>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-8">
                                        <div 
                                            className="h-8 rounded-full bg-blue-500 flex items-center justify-end pr-2" 
                                            style={{ width: `${percentage}%` }}
                                        >
                                            {percentage > 15 && (
                                                <span className="text-white text-xs font-medium">
                                                    {((amount / sortedCategories.reduce((sum, [, amt]) => sum + amt, 0)) * 100).toFixed(0)}%
                                                </span>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            );
                        })}
                        <div className="pt-3 border-t mt-4">
                            <div className="flex justify-between">
                                <span className="font-bold text-lg">Total Monthly Spending</span>
                                <span className="font-bold text-lg text-red-600">
                                    ${sortedCategories.reduce((sum, [, amount]) => sum + amount, 0).toFixed(2)}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            )}

            {savingsItems.length > 0 && (
                <SavingsTracker 
                    savingsItems={savingsItems}
                    savingsBalance={savingsBalance}
                    totalNeededSavings={totalNeededSavings}
                    totalSaved={totalSaved}
                    editingSavings={editingSavings}
                    setEditingSavings={setEditingSavings}
                    tempSavings={tempSavings}
                    setTempSavings={setTempSavings}
                    setSavingsBalance={setSavingsBalance}
                    getMonthlyAmount={getMonthlyAmount}
                    getSavedAmount={getSavedAmount}
                    addSavingsPayment={addSavingsPayment}
                    adjustSavings={adjustSavings}
                    subscriptions={subscriptions}
                />
            )}

            {budgets.length > 0 && (
                <div className="bg-white p-6 rounded-lg shadow">
                    <h2 className="text-xl font-bold mb-4">Budget Overview</h2>
                    <div className="space-y-4">
                        {budgets.map(budget => {
                            const spent = getCategorySpending(budget.category);
                            const percentage = (spent / budget.limit) * 100;
                            return (
                                <div key={budget.id}>
                                    <div className="flex justify-between mb-1">
                                        <span className="font-medium">{budget.category}</span>
                                        <span className="text-sm text-gray-600">${spent.toFixed(2)} / ${budget.limit}</span>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-3">
                                        <div 
                                            className={`h-3 rounded-full ${percentage > 100 ? 'bg-red-500' : percentage > 80 ? 'bg-orange-500' : 'bg-green-500'}`} 
                                            style={{ width: `${Math.min(percentage, 100)}%` }} 
                                        />
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            )}

            <div className="bg-white p-6 rounded-lg shadow">
                <h2 className="text-xl font-bold mb-4">Data Management</h2>
                <div className="flex flex-wrap gap-3">
                    <button onClick={exportData} className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                        <Download size={20} />
                        Export Data
                    </button>
                    <label className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 cursor-pointer">
                        <Upload size={20} />
                        Import Data
                        <input type="file" accept=".json" onChange={importData} className="hidden" />
                    </label>
                </div>
                <p className="text-sm text-gray-600 mt-2">Export your data to backup or transfer between devices</p>
            </div>
        </div>
    );
}
      function SavingsTracker({ savingsItems, savingsBalance, totalNeededSavings, totalSaved, editingSavings, setEditingSavings, tempSavings, setTempSavings, setSavingsBalance, getMonthlyAmount, getSavedAmount, addSavingsPayment, adjustSavings, subscriptions }) {
    return (
        <div className="bg-white p-6 rounded-lg shadow">
            <div className="flex justify-between items-center mb-4">
                <h2 className="text-xl font-bold">Savings Tracker</h2>
                <div className="flex items-center gap-4">
                    {editingSavings ? (
                        <div className="flex items-center gap-2">
                            <input
                                type="number"
                                step="0.01"
                                value={tempSavings}
                                onChange={(e) => setTempSavings(e.target.value)}
                                className="w-32 px-2 py-1 border rounded"
                            />
                            <button
                                onClick={() => {
                                    setSavingsBalance(parseFloat(tempSavings));
                                    setEditingSavings(false);
                                }}
                                className="px-3 py-1 bg-green-600 text-white rounded text-sm"
                            >
                                Save
                            </button>
                            <button
                                onClick={() => {
                                    setTempSavings(savingsBalance);
                                    setEditingSavings(false);
                                }}
                                className="px-3 py-1 bg-gray-300 rounded text-sm"
                            >
                                Cancel
                            </button>
                        </div>
                    ) : (
                        <div className="flex items-center gap-2">
                            <span className="text-sm text-gray-600">Savings Account:</span>
                            <span className="text-lg font-bold">${savingsBalance.toFixed(2)}</span>
                            <button
                                onClick={() => setEditingSavings(true)}
                                className="text-blue-600 hover:text-blue-800 text-sm"
                            >
                                Edit
                            </button>
                        </div>
                    )}
                </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div className="bg-blue-50 p-4 rounded">
                    <p className="text-sm text-gray-600">Total Saved for Bills</p>
                    <p className="text-2xl font-bold text-blue-600">${totalSaved.toFixed(2)}</p>
                </div>
                <div className="bg-orange-50 p-4 rounded">
                    <p className="text-sm text-gray-600">Total Needed</p>
                    <p className="text-2xl font-bold text-orange-600">${totalNeededSavings.toFixed(2)}</p>
                </div>
                <div className={`p-4 rounded ${savingsBalance >= totalNeededSavings ? 'bg-green-50' : 'bg-red-50'}`}>
                    <p className="text-sm text-gray-600">Account vs Needed</p>
                    <p className={`text-2xl font-bold ${savingsBalance >= totalNeededSavings ? 'text-green-600' : 'text-red-600'}`}>
                        {savingsBalance >= totalNeededSavings ? '+' : ''}${(savingsBalance - totalNeededSavings).toFixed(2)}
                    </p>
                </div>
            </div>

            <div className="space-y-3">
                {savingsItems.map(item => {
                    const saved = getSavedAmount(item);
                    const needed = parseFloat(item.amount);
                    const percentage = (saved / needed) * 100;
                    const monthly = getMonthlyAmount(item.amount, item.frequency);
                    const daysUntil = Math.ceil((new Date(item.nextPayment) - new Date()) / (1000 * 60 * 60 * 24));
                    
                    let statusColor = 'bg-green-500';
                    if (percentage < 100 && daysUntil <= 30) statusColor = 'bg-yellow-500';
                    if (percentage < 80) statusColor = 'bg-red-500';

                    return (
                        <div key={item.id} className="border rounded-lg p-4">
                            <div className="flex justify-between items-start mb-2">
                                <div>
                                    <p className="font-medium">{item.name}</p>
                                    <p className="text-sm text-gray-600">
                                        ${needed.toFixed(2)} {item.frequency} (${monthly.toFixed(2)}/mo)
                                    </p>
                                    <p className="text-xs text-gray-500">Due: {new Date(item.nextPayment).toLocaleDateString()}</p>
                                </div>
                                <div className="text-right">
                                    <p className="font-bold">${saved.toFixed(2)} / ${needed.toFixed(2)}</p>
                                    <p className="text-sm text-gray-600">{percentage.toFixed(0)}% saved</p>
                                </div>
                            </div>
                            <div className="w-full bg-gray-200 rounded-full h-3 mb-2">
                                <div className={`h-3 rounded-full ${statusColor}`} style={{ width: `${Math.min(percentage, 100)}%` }} />
                            </div>
                            <SavingsActions 
                                item={item} 
                                monthly={monthly} 
                                addSavingsPayment={addSavingsPayment}
                                adjustSavings={adjustSavings}
                                getSavedAmount={getSavedAmount}
                                type={subscriptions.find(s => s.id === item.id) ? 'subscription' : 'bill'}
                            />
                        </div>
                    );
                })}
            </div>
        </div>
    );
}

function SavingsActions({ item, monthly, addSavingsPayment, adjustSavings, getSavedAmount, type }) {
    const [showAdjust, setShowAdjust] = useState(false);
    const [adjustAmount, setAdjustAmount] = useState('');
    const [saveAmount, setSaveAmount] = useState(monthly.toFixed(2));

    const handleAddPayment = () => {
        if (saveAmount && parseFloat(saveAmount) > 0) {
            addSavingsPayment(item.id, saveAmount, type);
            setSaveAmount(monthly.toFixed(2));
        }
    };

    const handleAdjust = () => {
        if (adjustAmount && parseFloat(adjustAmount) >= 0) {
            adjustSavings(item.id, adjustAmount, type);
            setShowAdjust(false);
            setAdjustAmount('');
        }
    };

    return (
        <div className="flex gap-2 flex-wrap">
            {!showAdjust ? (
                <>
                    <div className="flex items-center gap-2">
                        <input
                            type="number"
                            step="0.01"
                            value={saveAmount}
                            onChange={(e) => setSaveAmount(e.target.value)}
                            className="w-24 px-2 py-1 border rounded text-sm"
                        />
                        <button
                            onClick={handleAddPayment}
                            className="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700"
                        >
                            ✓ Add to Savings
                        </button>
                    </div>
                    <button
                        onClick={() => {
                            setShowAdjust(true);
                            setAdjustAmount(getSavedAmount(item).toFixed(2));
                        }}
                        className="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700"
                    >
                        Adjust Total
                    </button>
                </>
            ) : (
                <div className="flex items-center gap-2">
                    <span className="text-sm">Set total saved:</span>
                    <input
                        type="number"
                        step="0.01"
                        value={adjustAmount}
                        onChange={(e) => setAdjustAmount(e.target.value)}
                        className="w-24 px-2 py-1 border rounded text-sm"
                    />
                    <button onClick={handleAdjust} className="px-3 py-1 bg-green-600 text-white rounded text-sm">
                        Save
                    </button>
                    <button onClick={() => setShowAdjust(false)} className="px-3 py-1 bg-gray-300 rounded text-sm">
                        Cancel
                    </button>
                </div>
            )}
        </div>
    );
}
      function Transactions({ transactions, onAdd, onDelete }) {
    const [filter, setFilter] = useState('all');
    const [searchTerm, setSearchTerm] = useState('');
    
    const filteredTransactions = transactions
        .filter(t => filter === 'all' || t.type === filter)
        .filter(t => 
            t.description.toLowerCase().includes(searchTerm.toLowerCase()) || 
            t.category.toLowerCase().includes(searchTerm.toLowerCase())
        )
        .sort((a, b) => new Date(b.date) - new Date(a.date));

    return (
        <div className="space-y-4">
            <div className="flex justify-between items-center">
                <h2 className="text-2xl font-bold">Transactions</h2>
                <button onClick={onAdd} className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    <PlusCircle size={20} />
                    Add Transaction
                </button>
            </div>
            
            <div className="bg-white p-4 rounded-lg shadow space-y-3">
                <input 
                    type="text" 
                    placeholder="Search transactions..." 
                    value={searchTerm} 
                    onChange={(e) => setSearchTerm(e.target.value)} 
                    className="w-full px-4 py-2 border rounded" 
                />
                <div className="flex gap-2">
                    {['all', 'income', 'expense'].map(f => (
                        <button 
                            key={f} 
                            onClick={() => setFilter(f)} 
                            className={`px-4 py-2 rounded ${filter === f ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
                        >
                            {f.charAt(0).toUpperCase() + f.slice(1)}
                        </button>
                    ))}
                </div>
            </div>
            
            <div className="bg-white rounded-lg shadow overflow-hidden">
                {filteredTransactions.length === 0 ? (
                    <p className="p-6 text-center text-gray-500">No transactions found</p>
                ) : (
                    <div className="divide-y">
                        {filteredTransactions.map(transaction => (
                            <div key={transaction.id} className="p-4 hover:bg-gray-50 flex justify-between items-center">
                                <div className="flex-1">
                                    <div className="flex items-center gap-2">
                                        <p className="font-medium">{transaction.description}</p>
                                        <span className={`px-2 py-1 text-xs rounded ${transaction.type === 'income' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                                            {transaction.type}
                                        </span>
                                    </div>
                                    <p className="text-sm text-gray-600">{transaction.category} • {transaction.source}</p>
                                    <p className="text-xs text-gray-500">{new Date(transaction.date).toLocaleDateString()}</p>
                                </div>
                                <div className="flex items-center gap-4">
                                    <p className={`text-xl font-bold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                                        {transaction.type === 'income' ? '+' : '-'}${transaction.amount}
                                    </p>
                                    <button onClick={() => onDelete(transaction.id)} className="text-red-600 hover:text-red-800">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                )}
            </div>
        </div>
    );
}

function Subscriptions({ subscriptions, onAdd, onEdit, onDelete, onToggleFlag, getMonthlyAmount, getSavedAmount, addSavingsPayment, adjustSavings }) {
    return (
        <div className="space-y-4">
            <div className="flex justify-between items-center">
                <h2 className="text-2xl font-bold">Subscriptions</h2>
                <button onClick={onAdd} className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    <PlusCircle size={20} />
                    Add Subscription
                </button>
            </div>
            
            <div className="bg-white rounded-lg shadow overflow-hidden">
                {subscriptions.length === 0 ? (
                    <p className="p-6 text-center text-gray-500">No subscriptions added yet</p>
                ) : (
                    <div className="divide-y">
                        {subscriptions.map(sub => {
                            const frequency = sub.frequency || 'Monthly';
                            const monthly = getMonthlyAmount(sub.amount, frequency);
                            const needsSavings = frequency !== 'Monthly';
                            const saved = needsSavings ? getSavedAmount(sub) : 0;

                            return (
                                <div key={sub.id} className={`p-4 ${sub.flaggedForCancellation ? 'bg-red-50' : 'hover:bg-gray-50'}`}>
                                    <div className="flex justify-between items-start">
                                        <div className="flex-1">
                                            <div className="flex items-center gap-2">
                                                <p className="font-medium text-lg">{sub.name}</p>
                                                {sub.flaggedForCancellation && (
                                                    <span className="px-2 py-1 text-xs bg-red-600 text-white rounded">To Cancel</span>
                                                )}
                                            </div>
                                            <p className="text-sm text-gray-600">
                                                ${parseFloat(sub.amount).toFixed(2)} {frequency}
                                                {frequency !== 'Monthly' && ` ($${monthly.toFixed(2)}/mo)`}
                                            </p>
                                            <p className="text-sm text-gray-600">Next payment: {new Date(sub.nextPayment).toLocaleDateString()}</p>
                                            <p className="text-sm text-gray-600">From: {sub.source}</p>
                                            {needsSavings && (
                                                <p className="text-sm font-medium text-blue-600 mt-1">
                                                    Saved: ${saved.toFixed(2)} / ${parseFloat(sub.amount).toFixed(2)}
                                                </p>
                                            )}
                                        </div>
                                        <div className="text-right">
                                            <p className="text-xl font-bold text-red-600">${monthly.toFixed(2)}/mo</p>
                                            <p className="text-sm text-gray-500">${(monthly * 12).toFixed(2)}/year</p>
                                        </div>
                                    </div>
                                    
                                    {needsSavings && (
                                        <div className="mt-3 pt-3 border-t">
                                            <SavingsActions 
                                                item={sub} 
                                                monthly={monthly} 
                                                addSavingsPayment={addSavingsPayment}
                                                adjustSavings={adjustSavings}
                                                getSavedAmount={getSavedAmount}
                                                type="subscription"
                                            />
                                        </div>
                                    )}
                                    
                                    <div className="flex gap-2 mt-3">
                                        <button 
                                            onClick={() => onToggleFlag(sub.id)} 
                                            className={`px-3 py-1 text-sm rounded ${sub.flaggedForCancellation ? 'bg-green-600 text-white hover:bg-green-700' : 'bg-orange-600 text-white hover:bg-orange-700'}`}
                                        >
                                            {sub.flaggedForCancellation ? 'Unflag' : 'Flag for Cancellation'}
                                        </button>
                                        <button onClick={() => onEdit(sub)} className="px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700">
                                            Edit
                                        </button>
                                        <button onClick={() => onDelete(sub.id)} className="px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700">
                                            Delete
                                        </button>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                )}
            </div>
        </div>
    );
}

function Bills({ bills, onAdd, onEdit, onDelete, onToggleFlag, getMonthlyAmount, getSavedAmount, addSavingsPayment, adjustSavings }) {
    return (
        <div className="space-y-4">
            <div className="flex justify-between items-center">
                <h2 className="text-2xl font-bold">Recurring Bills</h2>
                <button onClick={onAdd} className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    <PlusCircle size={20} />
                    Add Bill
                </button>
            </div>
            
            <div className="bg-white rounded-lg shadow overflow-hidden">
                {bills.length === 0 ? (
                    <p className="p-6 text-center text-gray-500">No recurring bills added yet</p>
                ) : (
                    <div className="divide-y">
                        {bills.map(bill => {
                            const frequency = bill.frequency || 'Monthly';
                            const monthly = getMonthlyAmount(bill.amount, frequency);
                            const needsSavings = frequency !== 'Monthly';
                            const saved = needsSavings ? getSavedAmount(bill) : 0;

                            return (
                                <div key={bill.id} className={`p-4 ${bill.flaggedForReview ? 'bg-yellow-50' : 'hover:bg-gray-50'}`}>
                                    <div className="flex justify-between items-start">
                                        <div className="flex-1">
                                            <div className="flex items-center gap-2">
                                                <p className="font-medium text-lg">{bill.name}</p>
                                                {bill.flaggedForReview && (
                                                    <span className="px-2 py-1 text-xs bg-yellow-600 text-white rounded">Review</span>
                                                )}
                                            </div>
                                            <p className="text-sm text-gray-600">
                                                ${parseFloat(bill.amount).toFixed(2)} {frequency}
                                                {frequency !== 'Monthly' && ` ($${monthly.toFixed(2)}/mo)`}
                                            </p>
                                            <p className="text-sm text-gray-600">Next payment: {new Date(bill.nextPayment).toLocaleDateString()}</p>
                                            <p className="text-sm text-gray-600">From: {bill.source}</p>
                                            {needsSavings && (
                                                <p className="text-sm font-medium text-blue-600 mt-1">
                                                    Saved: ${saved.toFixed(2)} / ${parseFloat(bill.amount).toFixed(2)}
                                                </p>
                                            )}
                                        </div>
                                        <div className="text-right">
                                            <p className="text-xl font-bold text-red-600">${monthly.toFixed(2)}/mo</p>
                                            <p className="text-sm text-gray-500">${(monthly * 12).toFixed(2)}/year</p>
                                        </div>
                                    </div>
                                    
                                    {needsSavings && (
                                        <div className="mt-3 pt-3 border-t">
                                            <SavingsActions 
                                                item={bill} 
                                                monthly={monthly} 
                                                addSavingsPayment={addSavingsPayment}
                                                adjustSavings={adjustSavings}
                                                getSavedAmount={getSavedAmount}
                                                type="bill"
                                            />
                                        </div>
                                    )}
                                    
                                    <div className="flex gap-2 mt-3">
                                        <button 
                                            onClick={() => onToggleFlag(bill.id)} 
                                            className={`px-3 py-1 text-sm rounded ${bill.flaggedForReview ? 'bg-green-600 text-white hover:bg-green-700' : 'bg-yellow-600 text-white hover:bg-yellow-700'}`}
                                        >
                                            {bill.flaggedForReview ? 'Unflag' : 'Flag for Review'}
                                        </button>
                                        <button onClick={() => onEdit(bill)} className="px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700">
                                            Edit
                                        </button>
                                        <button onClick={() => onDelete(bill.id)} className="px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700">
                                            Delete
                                        </button>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                )}
            </div>
        </div>
    );
}
      function Budgets({ budgets, onAdd, getCategorySpending }) {
    return (
        <div className="space-y-4">
            <div className="flex justify-between items-center">
                <h2 className="text-2xl font-bold">Budgets</h2>
                <button onClick={onAdd} className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    <PlusCircle size={20} />
                    Add Budget
                </button>
            </div>
            
            <div className="bg-white rounded-lg shadow overflow-hidden">
                {budgets.length === 0 ? (
                    <p className="p-6 text-center text-gray-500">No budgets set yet</p>
                ) : (
                    <div className="divide-y">
                        {budgets.map(budget => {
                            const spent = getCategorySpending(budget.category);
                            const percentage = (spent / budget.limit) * 100;
                            const remaining = budget.limit - spent;
                            
                            return (
                                <div key={budget.id} className="p-4">
                                    <div className="flex justify-between items-start mb-3">
                                        <div>
                                            <p className="font-medium text-lg">{budget.category}</p>
                                            <p className="text-sm text-gray-600">Monthly limit: ${budget.limit}</p>
                                        </div>
                                        <div className="text-right">
                                            <p className="text-xl font-bold">${spent.toFixed(2)}</p>
                                            <p className={`text-sm ${remaining >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                {remaining >= 0 ? `$${remaining.toFixed(2)} left` : `$${Math.abs(remaining).toFixed(2)} over`}
                                            </p>
                                        </div>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-4">
                                        <div 
                                            className={`h-4 rounded-full transition-all ${percentage > 100 ? 'bg-red-500' : percentage > 80 ? 'bg-orange-500' : 'bg-green-500'}`} 
                                            style={{ width: `${Math.min(percentage, 100)}%` }} 
                                        />
                                    </div>
                                    <p className="text-xs text-gray-600 mt-1">{percentage.toFixed(1)}% used</p>
                                </div>
                            );
                        })}
                    </div>
                )}
            </div>
        </div>
    );
}

function AddTransactionModal({ onClose, onAdd }) {
    const [formData, setFormData] = useState({
        type: 'expense',
        amount: '',
        description: '',
        category: '',
        source: '',
        date: new Date().toISOString().split('T')[0]
    });
    
    const categories = ['Groceries', 'Dining Out', 'Transportation', 'Entertainment', 'Utilities', 'Healthcare', 'Shopping', 'Other'];
    const sources = ['Checking Account', 'Credit Card', 'Savings', 'Cash', 'Other'];

    const handleSubmit = () => {
        if (!formData.amount || !formData.category || !formData.source) {
            alert('Please fill in all required fields');
            return;
        }
        const finalDescription = formData.description.trim() || formData.category;
        const finalAmount = parseFloat(formData.amount).toFixed(2);
        onAdd({
            ...formData,
            description: finalDescription,
            amount: finalAmount
        });
    };

    const handleAmountBlur = () => {
        if (formData.amount) {
            setFormData({...formData, amount: parseFloat(formData.amount).toFixed(2)});
        }
    };

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
                <h2 className="text-2xl font-bold mb-4">Add Transaction</h2>
                <div className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Type</label>
                        <div className="flex gap-2">
                            <button 
                                type="button" 
                                onClick={() => setFormData({...formData, type: 'expense'})} 
                                className={`flex-1 py-2 rounded ${formData.type === 'expense' ? 'bg-red-600 text-white' : 'bg-gray-200'}`}
                            >
                                Expense
                            </button>
                            <button 
                                type="button" 
                                onClick={() => setFormData({...formData, type: 'income'})} 
                                className={`flex-1 py-2 rounded ${formData.type === 'income' ? 'bg-green-600 text-white' : 'bg-gray-200'}`}
                            >
                                Income
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Amount</label>
                        <input 
                            type="number" 
                            step="0.01" 
                            value={formData.amount} 
                            onChange={(e) => setFormData({...formData, amount: e.target.value})}
                            onBlur={handleAmountBlur}
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Description (optional)</label>
                        <input 
                            type="text" 
                            value={formData.description} 
                            onChange={(e) => setFormData({...formData, description: e.target.value})} 
                            className="w-full px-3 py-2 border rounded"
                            placeholder={formData.category ? formData.category : 'Will use category name if empty'}
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <select 
                            value={formData.category} 
                            onChange={(e) => setFormData({...formData, category: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select category</option>
                            {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Source</label>
                        <select 
                            value={formData.source} 
                            onChange={(e) => setFormData({...formData, source: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select source</option>
                            {sources.map(src => <option key={src} value={src}>{src}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Date</label>
                        <input 
                            type="date" 
                            value={formData.date} 
                            onChange={(e) => setFormData({...formData, date: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button type="button" onClick={handleSubmit} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            Add
                        </button>
                        <button type="button" onClick={onClose} className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
}

function AddSubscriptionModal({ onClose, onAdd }) {
    const [formData, setFormData] = useState({ 
        name: '', 
        amount: '', 
        source: '', 
        frequency: 'Monthly',
        category: 'Entertainment',
        nextPayment: '', 
        flaggedForCancellation: false 
    });
    
    const sources = ['Checking Account', 'Credit Card', 'Savings', 'Other'];
    const frequencies = ['Monthly', 'Quarterly', 'Semi-Annual', 'Annual'];
    const categories = ['Entertainment', 'Education', 'Tools/Software', 'Health/Fitness', 'News/Media', 'Gaming', 'Other'];

    const handleSubmit = () => {
        if (!formData.name || !formData.amount || !formData.source || !formData.nextPayment) {
            alert('Please fill in all required fields');
            return;
        }
        const finalAmount = parseFloat(formData.amount).toFixed(2);
        onAdd({
            ...formData,
            amount: finalAmount
        });
    };

    const handleAmountBlur = () => {
        if (formData.amount) {
            setFormData({...formData, amount: parseFloat(formData.amount).toFixed(2)});
        }
    };

    const getMonthlyBreakdown = () => {
        if (!formData.amount || formData.frequency === 'Monthly') return '';
        const divisor = formData.frequency === 'Quarterly' ? 3 : formData.frequency === 'Semi-Annual' ? 6 : 12;
        return (parseFloat(formData.amount) / divisor).toFixed(2);
    };

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
                <h2 className="text-2xl font-bold mb-4">Add Subscription</h2>
                <div className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Name</label>
                        <input 
                            type="text" 
                            value={formData.name} 
                            onChange={(e) => setFormData({...formData, name: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Amount</label>
                        <input 
                            type="number" 
                            step="0.01" 
                            value={formData.amount} 
                            onChange={(e) => setFormData({...formData, amount: e.target.value})}
                            onBlur={handleAmountBlur}
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Frequency</label>
                        <select 
                            value={formData.frequency} 
                            onChange={(e) => setFormData({...formData, frequency: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {frequencies.map(freq => <option key={freq} value={freq}>{freq}</option>)}
                        </select>
                        {getMonthlyBreakdown() && (
                            <p className="text-xs text-gray-600 mt-1">
                                Monthly breakdown: ${getMonthlyBreakdown()}/mo
                            </p>
                        )}
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <select 
                            value={formData.category} 
                            onChange={(e) => setFormData({...formData, category: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Payment Source</label>
                        <select 
                            value={formData.source} 
                            onChange={(e) => setFormData({...formData, source: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select source</option>
                            {sources.map(src => <option key={src} value={src}>{src}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Next Payment Date</label>
                        <input 
                            type="date" 
                            value={formData.nextPayment} 
                            onChange={(e) => setFormData({...formData, nextPayment: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button type="button" onClick={handleSubmit} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            Add
                        </button>
                        <button type="button" onClick={onClose} className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
}
      function AddBillModal({ onClose, onAdd }) {
    const [formData, setFormData] = useState({ 
        name: '', 
        amount: '', 
        source: '', 
        frequency: 'Monthly',
        category: 'Utilities',
        nextPayment: '', 
        flaggedForReview: false 
    });
    
    const sources = ['Checking Account', 'Credit Card', 'Savings', 'Other'];
    const frequencies = ['Monthly', 'Quarterly', 'Semi-Annual', 'Annual'];
    const categories = ['Housing', 'Utilities', 'Insurance', 'Transportation', 'Other'];

    const handleSubmit = () => {
        if (!formData.name || !formData.amount || !formData.source || !formData.nextPayment) {
            alert('Please fill in all required fields');
            return;
        }
        const finalAmount = parseFloat(formData.amount).toFixed(2);
        onAdd({
            ...formData,
            amount: finalAmount
        });
    };

    const handleAmountBlur = () => {
        if (formData.amount) {
            setFormData({...formData, amount: parseFloat(formData.amount).toFixed(2)});
        }
    };

    const getMonthlyBreakdown = () => {
        if (!formData.amount || formData.frequency === 'Monthly') return '';
        const divisor = formData.frequency === 'Quarterly' ? 3 : formData.frequency === 'Semi-Annual' ? 6 : 12;
        return (parseFloat(formData.amount) / divisor).toFixed(2);
    };

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
                <h2 className="text-2xl font-bold mb-4">Add Recurring Bill</h2>
                <div className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Bill Name</label>
                        <input 
                            type="text" 
                            value={formData.name} 
                            onChange={(e) => setFormData({...formData, name: e.target.value})} 
                            className="w-full px-3 py-2 border rounded"
                            placeholder="e.g., Mortgage, Car Insurance, Electric"
                            required 
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Amount</label>
                        <input 
                            type="number" 
                            step="0.01" 
                            value={formData.amount} 
                            onChange={(e) => setFormData({...formData, amount: e.target.value})}
                            onBlur={handleAmountBlur}
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Frequency</label>
                        <select 
                            value={formData.frequency} 
                            onChange={(e) => setFormData({...formData, frequency: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {frequencies.map(freq => <option key={freq} value={freq}>{freq}</option>)}
                        </select>
                        {getMonthlyBreakdown() && (
                            <p className="text-xs text-gray-600 mt-1">
                                Monthly breakdown: ${getMonthlyBreakdown()}/mo
                            </p>
                        )}
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <select 
                            value={formData.category} 
                            onChange={(e) => setFormData({...formData, category: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Payment Source</label>
                        <select 
                            value={formData.source} 
                            onChange={(e) => setFormData({...formData, source: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select source</option>
                            {sources.map(src => <option key={src} value={src}>{src}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Next Payment Date</label>
                        <input 
                            type="date" 
                            value={formData.nextPayment} 
                            onChange={(e) => setFormData({...formData, nextPayment: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button type="button" onClick={handleSubmit} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            Add
                        </button>
                        <button type="button" onClick={onClose} className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
}

function AddBudgetModal({ onClose, onAdd }) {
    const [formData, setFormData] = useState({ category: '', limit: '' });
    const categories = ['Groceries', 'Dining Out', 'Transportation', 'Entertainment', 'Utilities', 'Healthcare', 'Shopping', 'Other'];

    const handleSubmit = () => {
        if (!formData.category || !formData.limit) {
            alert('Please fill in all required fields');
            return;
        }
        const finalLimit = parseFloat(formData.limit).toFixed(2);
        onAdd({
            ...formData,
            limit: finalLimit
        });
    };

    const handleLimitBlur = () => {
        if (formData.limit) {
            setFormData({...formData, limit: parseFloat(formData.limit).toFixed(2)});
        }
    };

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                <h2 className="text-2xl font-bold mb-4">Add Budget</h2>
                <div className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <select 
                            value={formData.category} 
                            onChange={(e) => setFormData({...formData, category: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select category</option>
                            {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Monthly Limit</label>
                        <input 
                            type="number" 
                            step="0.01" 
                            value={formData.limit} 
                            onChange={(e) => setFormData({...formData, limit: e.target.value})}
                            onBlur={handleLimitBlur}
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button type="button" onClick={handleSubmit} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            Add
                        </button>
                        <button type="button" onClick={onClose} className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
}
      function EditSubscriptionModal({ subscription, onClose, onUpdate }) {
    const [formData, setFormData] = useState({ 
        name: subscription.name,
        amount: subscription.amount,
        source: subscription.source,
        frequency: subscription.frequency || 'Monthly',
        category: subscription.category || 'Entertainment',
        nextPayment: subscription.nextPayment,
        flaggedForCancellation: subscription.flaggedForCancellation || false
    });
    
    const sources = ['Checking Account', 'Credit Card', 'Savings', 'Other'];
    const frequencies = ['Monthly', 'Quarterly', 'Semi-Annual', 'Annual'];
    const categories = ['Entertainment', 'Education', 'Tools/Software', 'Health/Fitness', 'News/Media', 'Gaming', 'Other'];

    const handleSubmit = () => {
        if (!formData.name || !formData.amount || !formData.source || !formData.nextPayment) {
            alert('Please fill in all required fields');
            return;
        }
        const finalAmount = parseFloat(formData.amount).toFixed(2);
        onUpdate(subscription.id, {
            ...formData,
            amount: finalAmount,
            savingsLog: subscription.savingsLog
        });
    };

    const handleAmountBlur = () => {
        if (formData.amount) {
            setFormData({...formData, amount: parseFloat(formData.amount).toFixed(2)});
        }
    };

    const getMonthlyBreakdown = () => {
        if (!formData.amount || formData.frequency === 'Monthly') return '';
        const divisor = formData.frequency === 'Quarterly' ? 3 : formData.frequency === 'Semi-Annual' ? 6 : 12;
        return (parseFloat(formData.amount) / divisor).toFixed(2);
    };

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
                <h2 className="text-2xl font-bold mb-4">Edit Subscription</h2>
                <div className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Name</label>
                        <input 
                            type="text" 
                            value={formData.name} 
                            onChange={(e) => setFormData({...formData, name: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Amount</label>
                        <input 
                            type="number" 
                            step="0.01" 
                            value={formData.amount} 
                            onChange={(e) => setFormData({...formData, amount: e.target.value})}
                            onBlur={handleAmountBlur}
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Frequency</label>
                        <select 
                            value={formData.frequency} 
                            onChange={(e) => setFormData({...formData, frequency: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {frequencies.map(freq => <option key={freq} value={freq}>{freq}</option>)}
                        </select>
                        {getMonthlyBreakdown() && (
                            <p className="text-xs text-gray-600 mt-1">
                                Monthly breakdown: ${getMonthlyBreakdown()}/mo
                            </p>
                        )}
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <select 
                            value={formData.category} 
                            onChange={(e) => setFormData({...formData, category: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Payment Source</label>
                        <select 
                            value={formData.source} 
                            onChange={(e) => setFormData({...formData, source: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select source</option>
                            {sources.map(src => <option key={src} value={src}>{src}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Next Payment Date</label>
                        <input 
                            type="date" 
                            value={formData.nextPayment} 
                            onChange={(e) => setFormData({...formData, nextPayment: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button type="button" onClick={handleSubmit} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            Update
                        </button>
                        <button type="button" onClick={onClose} className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
}

function EditBillModal({ bill, onClose, onUpdate }) {
    const [formData, setFormData] = useState({ 
        name: bill.name,
        amount: bill.amount,
        source: bill.source,
        frequency: bill.frequency || 'Monthly',
        category: bill.category || 'Utilities',
        nextPayment: bill.nextPayment,
        flaggedForReview: bill.flaggedForReview || false
    });
    
    const sources = ['Checking Account', 'Credit Card', 'Savings', 'Other'];
    const frequencies = ['Monthly', 'Quarterly', 'Semi-Annual', 'Annual'];
    const categories = ['Housing', 'Utilities', 'Insurance', 'Transportation', 'Other'];

    const handleSubmit = () => {
        if (!formData.name || !formData.amount || !formData.source || !formData.nextPayment) {
            alert('Please fill in all required fields');
            return;
        }
        const finalAmount = parseFloat(formData.amount).toFixed(2);
        onUpdate(bill.id, {
            ...formData,
            amount: finalAmount,
            savingsLog: bill.savingsLog
        });
    };

    const handleAmountBlur = () => {
        if (formData.amount) {
            setFormData({...formData, amount: parseFloat(formData.amount).toFixed(2)});
        }
    };

    const getMonthlyBreakdown = () => {
        if (!formData.amount || formData.frequency === 'Monthly') return '';
        const divisor = formData.frequency === 'Quarterly' ? 3 : formData.frequency === 'Semi-Annual' ? 6 : 12;
        return (parseFloat(formData.amount) / divisor).toFixed(2);
    };

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
                <h2 className="text-2xl font-bold mb-4">Edit Recurring Bill</h2>
                <div className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Bill Name</label>
                        <input 
                            type="text" 
                            value={formData.name} 
                            onChange={(e) => setFormData({...formData, name: e.target.value})} 
                            className="w-full px-3 py-2 border rounded"
                            placeholder="e.g., Mortgage, Car Insurance, Electric"
                            required 
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Amount</label>
                        <input 
                            type="number" 
                            step="0.01" 
                            value={formData.amount} 
                            onChange={(e) => setFormData({...formData, amount: e.target.value})}
                            onBlur={handleAmountBlur}
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Frequency</label>
                        <select 
                            value={formData.frequency} 
                            onChange={(e) => setFormData({...formData, frequency: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {frequencies.map(freq => <option key={freq} value={freq}>{freq}</option>)}
                        </select>
                        {getMonthlyBreakdown() && (
                            <p className="text-xs text-gray-600 mt-1">
                                Monthly breakdown: ${getMonthlyBreakdown()}/mo
                            </p>
                        )}
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <select 
                            value={formData.category} 
                            onChange={(e) => setFormData({...formData, category: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Payment Source</label>
                        <select 
                            value={formData.source} 
                            onChange={(e) => setFormData({...formData, source: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required
                        >
                            <option value="">Select source</option>
                            {sources.map(src => <option key={src} value={src}>{src}</option>)}
                        </select>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-1">Next Payment Date</label>
                        <input 
                            type="date" 
                            value={formData.nextPayment} 
                            onChange={(e) => setFormData({...formData, nextPayment: e.target.value})} 
                            className="w-full px-3 py-2 border rounded" 
                            required 
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button type="button" onClick={handleSubmit} className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            Update
                        </button>
                        <button type="button" onClick={onClose} className="flex-1 bg-gray-300 py-2 rounded hover:bg-gray-400">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<BudgetTracker />);
    </script>
</body>
</html>
